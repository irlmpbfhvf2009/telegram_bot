var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{a as r,b as s,c as n}from"./app.d7951589.js";import{d as i}from"./index.a04c6204.js";import{d,r as u,q as c,_ as m,i as p,o as g,e as v,k as y,F as f,f as b,u as h,j as D,t as T,l as w,v as x,x as C,L as _,a as j,c as k,w as F,b as I,g as O,h as S,y as z,z as q}from"./index.202de73a.js";import{T as V}from"./index.1ae80648.js";import{a as L}from"./table.b0327cd7.js";const G=d({setup(){const e=u(null),a={index:1,size:30,total:0};let t=u(""),l=u([]),o=u(!0),s=u(!0),n=c("active"),d=u(!1);const m=i=>{if(s.value=!0,i||o.value)o.value=!1,a.index=1,e.value&&(e.value.scrollTop=0);else if(a.index*a.size>=a.total)return s.value=!1,void(d.value=!0);a.index,a.size,t.value,r().then((e=>{1===a.index?(l.value=e.data.list,n.value=l.value[0]):l.value=l.value.concat(e.data.list)})).catch((e=>{a.index=1,a.total=0,l.value=[]})).finally((()=>{s.value=!1}))},p=i(300,m);return m(!0),{listDom:e,loading:s,nomore:d,input:t,list:l,active:n,getCategoryData:m,searchData:p,changeActive:e=>{n.value=e}}}}),$={class:"category"},E=(e=>(x("data-v-73b8edad"),e=e(),C(),e))((()=>D("div",{class:"header-box"},[D("h2",null,"群组列表")],-1))),P={class:"list system-scrollbar",ref:"listDom","infinite-scroll-immediate":!1,style:{overflow:"auto"}},U=["onClick"],A={key:0,class:"load-tip"},B={key:1,class:"load-tip"};var J=m(G,[["render",function(e,a,t,l,o,r){const s=p("infinite-scroll");return g(),v("div",$,[E,y((g(),v("ul",P,[(g(!0),v(f,null,b(e.list,(a=>(g(),v("li",{key:a.groupId,class:h({active:a.groupId===e.active.groupId}),onClick:t=>e.changeActive(a)},[D("span",null,T(a.groupTitle),1)],10,U)))),128)),e.loading?(g(),v("p",A,"加载中...")):w("",!0),e.nomore?(g(),v("p",B,"数据加载完成")):w("",!0)])),[[s,e.getCategoryData]])])}],["__scopeId","data-v-73b8edad"]]);const N=d({components:{Layer:_},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const t=u(null),l=u(null);let o=u({name:""});return e.layer.row&&(o.value=JSON.parse(JSON.stringify(e.layer.row))),{form:o,rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入数字",trigger:"blur"}],choose:[{required:!0,message:"请选择",trigger:"blur"}],radio:[{required:!0,message:"请选择",trigger:"blur"}]},layerDom:l,ruleForm:t}},methods:{submit(){this.ruleForm&&this.ruleForm.validate((e=>{if(!e)return!1;{let e=this.form;this.layer.row?this.updateForm(e):this.addForm(e)}}))},addForm(e){L(e).then((e=>{this.$message({type:"success",message:"新增成功"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()}))},updateForm(e){s(e).then((e=>{this.$message({type:"success",message:"编辑成功"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()}))}}});const H=d({components:{Table:V,Layer:m(N,[["render",function(e,a,t,l,o,r){const s=j("el-form-item"),n=j("el-input"),i=j("el-form"),d=j("Layer",!0);return g(),k(d,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:F((()=>[I(i,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:F((()=>[I(s,{label:"群组名称：",prop:"groupTitle"},{default:F((()=>[O(T(e.form.groupTitle),1)])),_:1}),I(s,{label:"间隔秒数：",prop:"advertiseTime"},{default:F((()=>[I(n,{modelValue:e.form.advertiseTime,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.advertiseTime=a),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"只能输入正整数"},null,8,["modelValue"])])),_:1}),I(s,{label:"广告内容：",prop:"advertiseContent"},{default:F((()=>[I(n,{type:"textarea",rows:25,modelValue:e.form.advertiseContent,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.advertiseContent=a)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["layer","onConfirm"])}]])},setup(){const e=S({input:""}),r=S({show:!1,title:"新增",showButton:!0}),s=S({index:1,size:20,total:0}),i=c("active"),d=u(!0),m=u([]),p=u([]),g=r=>{d.value=!0,r&&(s.index=1);let u=((e,r)=>{for(var s in r||(r={}))t.call(r,s)&&o(e,s,r[s]);if(a)for(var s of a(r))l.call(r,s)&&o(e,s,r[s]);return e})({category:i.value.groupId,page:s.index,pageSize:s.size},e);n(u).then((e=>{let a=e.data.list;console.log("data"),console.log(a),m.value=e.data.list})).catch((e=>{m.value=[],s.index=1,s.total=0})).finally((()=>{d.value=!1}))};return z(i,(e=>{g(!0)})),{query:e,tableData:m,chooseData:p,loading:d,page:s,layer:r,handleSelectionChange:e=>{console.log("1132"),console.log(e),p.value=e},handleEdit:e=>{r.title="编辑数据",console.log(e),r.row=e,r.show=!0},getTableData:g}}}),K={class:"layout-container"},M={class:"layout-container-table"};const Q=d({name:"categoryTable",components:{Category:J,myTable:m(H,[["render",function(e,a,t,l,o,r){const s=j("el-table-column"),n=j("el-button"),i=j("Table"),d=j("Layer"),u=p("loading");return g(),v("div",K,[D("div",M,[y((g(),k(i,{ref:"table",page:e.page,"onUpdate:page":a[0]||(a[0]=a=>e.page=a),showIndex:!1,showSelection:!1,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:F((()=>[I(s,{prop:"advertiseContent",label:"广告内容",align:"center"}),I(s,{prop:"advertiseTime",label:"间隔秒数",align:"center"}),I(s,{label:"操作",align:"center",fixed:"right",width:"200"},{default:F((a=>[I(n,{onClick:t=>e.handleEdit(a.row)},{default:F((()=>[O("编辑")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[u,e.loading]]),e.layer.show?(g(),k(d,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):w("",!0)])])}],["__scopeId","data-v-d08ed6ee"]])},setup(){let e=u({});q("active",e)}}),R={class:"full"},W={class:"left"},X={class:"content"};var Y=m(Q,[["render",function(e,a,t,l,o,r){const s=j("category"),n=j("my-table");return g(),v("div",R,[D("div",W,[I(s)]),D("div",X,[I(n)])])}],["__scopeId","data-v-32bf03be"]]);export{Y as default};
